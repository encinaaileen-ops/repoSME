@{
    ViewBag.Title = "Dashboard";
    Layout = "~/Views/Shared/_MainLayout.cshtml";
}

<style>
    .home-button {
        padding: 20px;
    }

    .home-button i {
        margin-bottom: 10px;
    }

    .row.equal > div {
        display: flex;
    }

    .row.equal > div > .panel {
        width: 100%;
    }

    .stat-percent {
        float: right;
    }

    .color-blue {
        color: #1ab394;
    }

    .ibox {
        background: #fff;
        border: 1px solid #e7eaec;
        margin-bottom: 20px;
    }

    .ibox-title {
        background: #fff;
        border-bottom: 1px solid #e7eaec;
        padding: 15px;
    }

    .ibox-title h3 {
        margin: 0;
        font-size: 16px;
        font-weight: 600;
    }

    .ibox-content {
        padding: 20px;
    }

    .no-margins {
        margin: 0 !important;
    }

    .activity-stream {
        max-height: 300px;
        overflow-y: auto;
    }

    .label {
        padding: 3px 8px;
        font-size: 11px;
        font-weight: 600;
    }

    @@media (min-width: 992px) {
        .equal {
            display: -ms-flexbox;
            display: -webkit-flex;
            display: flex;
        }
    }
</style>

<div class="row">
    <div class="col-sm-12">
        <div class="row">
            <div class="col-lg-6">
                <h3 style="margin-bottom:20px;padding-left:5px;">Welcome, @ViewBag.UserDisplayName</h3>

                <div class="panel-group" id="accordion">
                    <!-- Census Management Panel -->
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h5 class="panel-title">
                                <a aria-expanded="false" class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">Census Management</a>
                                <span class="pull-right">
                                    <span class="label label-info">2</span>
                                    <span class="label label-primary">5</span>
                                    <span class="label label-warning">3</span>
                                    <span class="label label-danger">1</span>
                                </span>
                            </h5>
                        </div>
                        <div aria-expanded="false" id="collapseOne" class="panel-collapse collapse in">
                            <div class="panel-body">
                                <ul class="list-group clear-list m-t">
                                    <li class="list-group-item">
                                        <span class="pull-right">11</span>
                                        <span class="label label-danger"><i class="fa fa-briefcase"></i></span> Total Pending Census Transactions
                                    </li>
                                    <li class="list-group-item">
                                        <span class="pull-right"></span>
                                        <a href="@Url.Action("Index", "SampleList")" class="btn btn-primary"><i class="fa fa-check"></i> Go to Census Tasks</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Claims Panel -->
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a aria-expanded="false" class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">Claims</a>
                                <span class="pull-right">
                                    <span class="label label-info">1</span>
                                    <span class="label label-primary">3</span>
                                    <span class="label label-warning">2</span>
                                    <span class="label label-danger">0</span>
                                </span>
                            </h4>
                        </div>
                        <div aria-expanded="false" id="collapseTwo" class="panel-collapse collapse">
                            <div class="panel-body">
                                <div style="margin-top:-10px; margin-bottom:10px">
                                    Evaluation SLA
                                    <span class="pull-right">
                                        <span class="label label-primary">3</span>
                                        <span class="label label-warning">2</span>
                                        <span class="label label-danger">0</span>
                                    </span>
                                </div>
                                <div>
                                    Broker Review SLA
                                    <span class="pull-right">
                                        <span class="label label-primary">1</span>
                                        <span class="label label-danger">0</span>
                                    </span>
                                </div>
                                <ul class="list-group clear-list m-t">
                                    <li class="list-group-item">
                                        <span class="pull-right">6</span>
                                        <span class="label label-danger"><i class="fa fa-briefcase"></i></span> Total Pending Claims
                                    </li>
                                    <li class="list-group-item">
                                        <span class="pull-right">3.5 d</span>
                                        <span class="label label-info"><i class="fa fa-clock-o"></i></span> Current TAT
                                    </li>
                                    <li class="list-group-item">
                                        <span class="pull-right"></span>
                                        <a href="@Url.Action("Index", "SampleList")" class="btn btn-primary"><i class="fa fa-calculator"></i> Go to Claims</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Calendar Reminders -->
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a aria-expanded="false" class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseThree">Calendar Reminders</a>
                                <span class="pull-right">
                                    <span class="label label-warning">3</span>
                                </span>
                            </h4>
                        </div>
                        <div aria-expanded="false" id="collapseThree" class="panel-collapse collapse">
                            <div class="panel-body">
                                <ul class="list-group clear-list">
                                    <li class="list-group-item">
                                        <span class="pull-right text-muted">Today</span>
                                        <i class="fa fa-bell text-warning"></i> Policy renewal due
                                    </li>
                                    <li class="list-group-item">
                                        <span class="pull-right text-muted">Tomorrow</span>
                                        <i class="fa fa-bell text-info"></i> Client meeting
                                    </li>
                                    <li class="list-group-item">
                                        <span class="pull-right text-muted">Next Week</span>
                                        <i class="fa fa-bell text-success"></i> Quarterly review
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-6">
                <!-- Charts/Stats Section -->
                <div class="row">
                    <div class="col-lg-12">
                        <h3>Claims Volume Over Time</h3>
                        <div id="ClaimsVolumeOverTime" style="height: 190px;"></div>
                    </div>
                </div>

                <!-- Announcements -->
                <div class="row">
                    <div class="col-lg-12">
                        <div class="ibox">
                            <div class="ibox-content">
                                <h3><i class="fa fa-newspaper-o"></i> Announcements</h3>
                                <div class="activity-stream">
                                    <div class="stream">
                                        <div class="stream-badge">
                                            <i class="fa fa-bullhorn bg-primary"></i>
                                        </div>
                                        <div class="stream-panel">
                                            <div class="stream-info">
                                                <span class="date">Today at 2:30 PM</span>
                                                <div class="font-bold">System Maintenance</div>
                                                <div class="well p-xs" style="margin-bottom:3px;margin-top:4px;">
                                                    Scheduled maintenance this weekend from 10 PM to 2 AM.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="stream">
                                        <div class="stream-badge">
                                            <i class="fa fa-calendar bg-info"></i>
                                        </div>
                                        <div class="stream-panel">
                                            <div class="stream-info">
                                                <span class="date">Yesterday</span>
                                                <div class="font-bold">New Feature Release</div>
                                                <div class="well p-xs" style="margin-bottom:3px;margin-top:4px;">
                                                    Enhanced reporting features now available in the Reports section.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics Row -->
        <div class="row">
            <div class="col-lg-12">
                <div class="row">
                    <div class="col-lg-3">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h3>Active Members</h3>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">2,543</h1>
                                <div>
                                    <div class="stat-percent font-bold color-blue">11</div>
                                    <small>Pending Census Transactions</small>
                                </div>
                                <div>
                                    <div class="stat-percent font-bold color-blue">91%</div>
                                    <small>Within SLA</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h3>Active Clients</h3>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">48</h1>
                                <div>
                                    <div class="stat-percent font-bold color-blue">156</div>
                                    <small>Active Policies</small>
                                </div>
                                <div>
                                    <div class="stat-percent font-bold color-blue">12</div>
                                    <small>Renewals Within 3 Months</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h3>Pending Claims</h3>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">6</h1>
                                <div>
                                    <div class="stat-percent font-bold color-blue">$45.2K</div>
                                    <small>Pending Claims Value</small>
                                </div>
                                <div>
                                    <div class="stat-percent font-bold color-blue">83%</div>
                                    <small>Within SLA</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h3>Premium</h3>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">$2.4M</h1>
                                <div>
                                    <div class="stat-percent font-bold color-blue">$485K</div>
                                    <small>Total Remuneration</small>
                                </div>
                                <div>
                                    <div class="stat-percent font-bold color-blue">$191</div>
                                    <small>Remuneration Per Member</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="container-fluid">
            <div class="row equal">
                <div class="col-lg-2">
                    <div class="panel panel-danger">
                        <div class="panel-heading text-center">
                            <h3>
                                <a class="text-white" href="@Url.Action("Create", "SampleForm")">Add Employee</a>
                            </h3>
                        </div>
                        <div class="panel-body text-center home-button">
                            <i class="fa fa-plus-square-o fa-3x text-danger"></i>
                            <p>
                                <small><a href="@Url.Action("Create", "SampleForm")">Add new employee details</a></small>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2">
                    <div class="panel panel-info">
                        <div class="panel-heading text-center">
                            <h3>
                                <a class="text-white" href="@Url.Action("Index", "SampleList")">Search Member</a>
                            </h3>
                        </div>
                        <div class="panel-body text-center home-button">
                            <i class="fa fa-id-card fa-3x text-info"></i>
                            <p>
                                <small><a href="@Url.Action("Index", "SampleList")">Find an employee</a></small>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2">
                    <div class="panel panel-warning">
                        <div class="panel-heading text-center">
                            <h3>
                                <a class="text-white" href="@Url.Action("Index", "SampleList")">Census Tasks</a>
                            </h3>
                        </div>
                        <div class="panel-body text-center home-button">
                            <i class="fa fa-user fa-3x color-yellow"></i>
                            <p>
                                <small><a href="@Url.Action("Index", "SampleList")">Action pending tasks</a></small>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2">
                    <div class="panel panel-default">
                        <div class="panel-heading text-center">
                            <h3>
                                <a class="text-primary" href="#">Rewards</a>
                            </h3>
                        </div>
                        <div class="panel-body text-center home-button">
                            <i class="fa fa-percent fa-3x text-danger"></i>
                            <p>
                                <small><a href="#">Search rewards</a></small>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2">
                    <div class="panel panel-primary">
                        <div class="panel-heading text-center">
                            <h3>
                                <a class="text-white" href="#">Reports</a>
                            </h3>
                        </div>
                        <div class="panel-body text-center home-button">
                            <i class="fa fa-folder-open-o fa-3x"></i>
                            <p>
                                <small><a href="#">Do you need a report?</a></small>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-2">
                    <div class="panel panel-success">
                        <div class="panel-heading text-center">
                            <h3>
                                <a class="text-white" href="#">Contact & Support</a>
                            </h3>
                        </div>
                        <div class="panel-body text-center home-button">
                            <i class="fa fa-question fa-3x text-success"></i>
                            <p>
                                <small><a href="#">Do you need help?</a></small>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Section -->
        <div class="container-fluid">
            <h4 style="margin-bottom: 15px; margin-top: 10px;"><i class="fa fa-cog"></i> Administration</h4>
            <div class="row equal">
                <div class="col-lg-2">
                    <div class="panel panel-default" style="border-left: 3px solid #23c6c8;">
                        <div class="panel-heading text-center" style="background-color: #23c6c8; color: white;">
                            <h3>
                                <a class="text-white" href="@Url.Action("Products", "SMEProduct")">SME Products Admin</a>
                            </h3>
                        </div>
                        <div class="panel-body text-center home-button">
                            <i class="fa fa-cubes fa-3x" style="color: #23c6c8;"></i>
                            <p>
                                <small><a href="@Url.Action("Products", "SMEProduct")">Manage SME Portal products</a></small>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Initialize Kendo Chart matching reference BenefitNetFlex styling
            $("#ClaimsVolumeOverTime").kendoChart({
                theme: "fiori",
                legend: {
                    position: "bottom",
                    labels: {
                        font: "12px Arial, Helvetica, sans-serif"
                    }
                },
                chartArea: {
                    background: "transparent",
                    height: 190
                },
                dataSource: {
                    data: [
                        { Month: "Jan", PendingClaimsVolume: 12, ClosedClaimsVolume: 8 },
                        { Month: "Feb", PendingClaimsVolume: 19, ClosedClaimsVolume: 15 },
                        { Month: "Mar", PendingClaimsVolume: 3, ClosedClaimsVolume: 10 },
                        { Month: "Apr", PendingClaimsVolume: 5, ClosedClaimsVolume: 8 },
                        { Month: "May", PendingClaimsVolume: 2, ClosedClaimsVolume: 12 },
                        { Month: "Jun", PendingClaimsVolume: 6, ClosedClaimsVolume: 10 }
                    ]
                },
                seriesDefaults: {
                    type: "column",
                    gap: 0.5,
                    spacing: 0.1
                },
                series: [{
                    field: "PendingClaimsVolume",
                    name: "Pending Claims",
                    color: "#5cbae5"
                }, {
                    field: "ClosedClaimsVolume",
                    name: "Closed Claims",
                    color: "#b6d957"
                }],
                categoryAxis: {
                    field: "Month",
                    labels: {
                        font: "12px Arial, Helvetica, sans-serif"
                    },
                    majorGridLines: {
                        visible: false
                    }
                },
                valueAxis: {
                    labels: {
                        format: "{0:N0}",
                        font: "12px Arial, Helvetica, sans-serif"
                    },
                    majorGridLines: {
                        visible: true,
                        color: "#e0e0e0"
                    },
                    line: {
                        visible: false
                    }
                },
                tooltip: {
                    visible: true,
                    format: "{0}",
                    template: "#= series.name #: #= value #"
                }
            });

            // Load chart data from server
            $.ajax({
                url: '/Report/GetClaimsVolumeOverTime',
                success: function(data) {
                    if (data && data.length > 0) {
                        var chart = $("#ClaimsVolumeOverTime").data("kendoChart");
                        if (chart) {
                            chart.dataSource.data(data);
                        }
                    }
                },
                error: function() {
                    // Keep default data if endpoint doesn't exist
                }
            });

            // Initialize collapse panels
            $('.panel-collapse').on('shown.bs.collapse', function() {
                $(this).parent().find(".fa-chevron-down").removeClass("fa-chevron-down").addClass("fa-chevron-up");
            });

            $('.panel-collapse').on('hidden.bs.collapse', function() {
                $(this).parent().find(".fa-chevron-up").removeClass("fa-chevron-up").addClass("fa-chevron-down");
            });
        });
    </script>
}